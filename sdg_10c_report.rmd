---
title: "SDG 10.C"
author: "Emily Robinson, Nathanael Sheehan, Owain Harris"
date: "05/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Data analysis

The analysis presented in this report addresses an underrepresented understanding of research and dialogue on global remittance corridors and their effect on the global economic climate. Through following an anti naturalist methodology, our analysis does not seek to explain the social human phenomenon of migrant capital exchange simply through the causal dependence of social reality representation, nor does it wish to exploit the privacy concerns of highly aggregated data which in its purest form is tremendously sensitive, instead, the analysis aims to build a dialogue around climate vulnerable countries and their digital manifestation in open data from the private sector, and the impacts this has on the Sustainable Development Goals policy framework. 

As previously stated, there are two components of SDG 10.C, as delineated in the SDG metadata, the first component states “transaction costs for migrant remittances should be 3% or less by 2030”. Here, a transaction is defined as “Global average total cost of sending $200 (or equivalent in local sending currency) and expressed as % of amount sent” . The second component is to eliminate corridors “where cost is 5% or higher”, meaning that it should be possible for remittance senders to send capital to the “beneficiary for an average cost of 5% or less of the amount sent”.

## Library Installation
```{r eval=FALSE}

####
####
# Aim: Install and load packages required for analysis --------------------
####
####

# list CRAN packages used
pkgs = c("od", # generate OD lines
         "tidyverse", # for data cleaning
         "stringr", # for string manipulation
         "tidygeocoder", # OSM api used to calculate OD between corridors
         "sf" ) # simple feature handling

# Install pkgs not yet installed
installed_packages = pkgs %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(pkgs[!installed_packages])
}

# Load pkgs
invisible(lapply(pkgs, library, character.only = TRUE))


```

## Data Tidying
```{r eval=FALSE}
####
####
# Aim: Read, clean and document data from the World Bank for analysis --------------------
####
####

# Read world bank remitance corridor data ----------------------------------------------------
#### notes: this data is not avaliable from the WorldBank R oackage WDI
#### the data has been downloaded from: https://databank.worldbank.org/source/remittance-prices-worldwide-(corridors)

data_corridors = read.csv("data/36d1ed87-9a2d-41da-8eac-c1c25d45fa65_Data.csv") # local path
colnames(data_corridors)[1] = "Sending.Countries.Name" # rename column because its called some funky shit

data_corridors[data_corridors == ".."] = NA # convert .. missing values to NA

data_corridors[, 7:41] = sapply(data_corridors[, 7:41], as.numeric) # convert data corridor values to numeric


# Generate main dataframe -------------------------------------------------
data = data_corridors %>% filter(X2020Q3..YR2020Q3. != "..") %>%
  mutate('2011' = (X2011Q1..YR2011Q1. + X2011Q3..YR2011Q3.) / 2) %>% # generate yearly average
  mutate('2012' = (X2012Q1..YR2012Q1. + X2012Q3..YR2012Q3.) / 2) %>%
  mutate('2013' = (X2013Q1..YR2013Q1. + X2013Q1..YR2013Q1.) / 2) %>%
  mutate('2014' = (X2014Q1..YR2014Q1. + X2014Q3..YR2014Q3.) / 2) %>%
  mutate('2015' = (X2015Q1..YR2015Q1. + X2015Q3..YR2015Q3.) / 2) %>%
  mutate('2016' = (X2016Q1..YR2016Q1. + X2016Q3..YR2016Q3.) / 2) %>%
  mutate('2017' = (X2017Q1..YR2017Q1. + X2017Q3..YR2017Q3.) / 2) %>%
  mutate('2018' = (X2018Q1..YR2018Q1. + X2018Q3..YR2018Q3.) / 2) %>%
  mutate('2019' = (X2019Q1..YR2019Q1. + X2019Q3..YR2019Q3.) / 2) %>%
  mutate('2020' = (X2020Q1..YR2020Q1. + X2020Q3..YR2020Q3.) / 2) %>%
  select(
    Sending.Countries.Name,
    # select useful data
    Sending.Countries.Code,
    Receiving.Countries..Name,
    Receiving.Countries..Code,
    '2011',
    '2012',
    '2013',
    '2014',
    '2015',
    '2016',
    '2017',
    '2018',
    '2019',
    '2020'
  ) %>% gather(year, value, (5:14)) %>% # gather data into long format
  na.omit() %>% # remove any NA
  mutate(sdg_target = as.numeric(value < 5))  %>% # create new column with numeric boolean identifying if an SDG target has succeeded
  mutate( # rename country names to match OSM API
    Sending.Countries.Name = str_replace(
      Sending.Countries.Name,
      "United States of America",
      "United States"
    )
  )  %>%
  mutate(Sending.Countries.Name = str_replace(Sending.Countries.Name,
                                              " Korea, Rep.",
                                              "South Korea"))

##### View total SDG Targets
table(data$sdg_target) # 0 = no 1 = yes

```
